<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width,initial-scale=1,maximum-scale=1,user-scalable=no">
<title>Snake Game</title>
<style>
body{margin:0;overflow:hidden;background:#1a1a2e;font-family:Arial,sans-serif;display:flex;justify-content:center;align-items:center;height:100vh;color:white;}
#game{background:#0f3460;box-shadow:0 0 30px rgba(0,0,0,0.8);display:block;max-width:100vw;max-height:100vh;}
#ui{position:fixed;top:20px;left:20px;font-size:20px;font-weight:bold;}
#gameOver{position:fixed;inset:0;display:none;align-items:center;justify-content:center;flex-direction:column;background:rgba(0,0,0,0.9);text-align:center;}
button{padding:12px 30px;border:none;border-radius:8px;font-size:18px;background:#22c55e;color:white;font-weight:bold;cursor:pointer;margin-top:20px;}
.back{position:fixed;top:20px;right:20px;padding:8px 16px;font-size:14px;}
@media(max-width:768px){
 #game{width:100vw!important;height:100vh!important;}
 #ui{font-size:16px;top:10px;left:10px;}
 .back{top:10px;right:10px;padding:6px 12px;font-size:12px;}
 button{padding:10px 20px;font-size:16px;}
}
</style>
</head>
<body>
<button class="back" onclick="location.href='index.html'">← Back</button>
<div id="ui">Score: 0 | Level: 1</div>
<div id="gameOver">
 <h1>GAME OVER</h1>
 <div id="finalScore"></div>
 <button onclick="location.reload()">Restart</button>
 <button onclick="location.href='index.html'">Back to Menu</button>
</div>
<canvas id="game"></canvas>
<script>
const canvas=document.getElementById("game");
const ctx=canvas.getContext("2d");
canvas.width=800;
canvas.height=800;
const grid=20;
let score=0,level=1,speed=150;
let difficulty=localStorage.getItem('gameDifficulty')||'easy';
if(difficulty==='easy')speed=180;
if(difficulty==='medium')speed=130;
if(difficulty==='hard')speed=90;
let snake=[{x:10,y:10}];
let dx=1,dy=0;
let food={x:15,y:15};
let obstacles=[];
let powerup=null;
let gameRunning=true;
let keys={};

window.addEventListener('keydown',e=>{
 keys[e.key]=true;
 if((e.key==='ArrowUp'||e.key==='w'||e.key==='W')&&dy===0){dx=0;dy=-1;}
 if((e.key==='ArrowDown'||e.key==='s'||e.key==='S')&&dy===0){dx=0;dy=1;}
 if((e.key==='ArrowLeft'||e.key==='a'||e.key==='A')&&dx===0){dx=-1;dy=0;}
 if((e.key==='ArrowRight'||e.key==='d'||e.key==='D')&&dx===0){dx=1;dy=0;}
});

function spawnFood(){
 food={x:Math.floor(Math.random()*(canvas.width/grid)),y:Math.floor(Math.random()*(canvas.height/grid))};
}

function spawnObstacles(){
 obstacles=[];
 for(let i=0;i<level*2;i++){
  obstacles.push({x:Math.floor(Math.random()*(canvas.width/grid)),y:Math.floor(Math.random()*(canvas.height/grid))});
 }
}

function spawnPowerup(){
 if(Math.random()<0.3){
  powerup={x:Math.floor(Math.random()*(canvas.width/grid)),y:Math.floor(Math.random()*(canvas.height/grid)),type:'speed'};
 }
}

function update(){
 if(!gameRunning)return;
 let head={x:snake[0].x+dx,y:snake[0].y+dy};
 
 // Check wall collision
 if(head.x<0||head.x>=canvas.width/grid||head.y<0||head.y>=canvas.height/grid){
  gameOver();
  return;
 }
 
 // Check self collision (skip head at index 0)
 for(let i=1;i<snake.length;i++){
  if(head.x===snake[i].x&&head.y===snake[i].y){
   gameOver();
   return;
  }
 }
 
 // Check obstacle collision
 for(let o of obstacles){
  if(head.x===o.x&&head.y===o.y){
   gameOver();
   return;
  }
 }
 
 snake.unshift(head);
 if(head.x===food.x&&head.y===food.y){
  score+=10;
  spawnFood();
  if(score>=level*50){
   level++;
   speed=Math.max(50,speed-8);
   spawnObstacles();
   snake.forEach((s,i)=>{
    if(i>0&&Math.random()<0.3)snake.splice(i,1);
   });
  }
  spawnPowerup();
 }else{
  snake.pop();
 }
 if(powerup&&head.x===powerup.x&&head.y===powerup.y){
  score+=20;
  powerup=null;
 }
}

function draw(){
 ctx.fillStyle='#0f3460';
 ctx.fillRect(0,0,canvas.width,canvas.height);
 
 // Draw brick wall borders
 const wallThickness=grid;
 // Top wall
 for(let x=0;x<canvas.width;x+=grid*2){
  ctx.fillStyle='#8b4513';
  ctx.fillRect(x,0,grid*2-2,wallThickness);
  ctx.fillStyle='#654321';
  ctx.fillRect(x+2,2,grid*2-6,wallThickness-4);
 }
 // Bottom wall
 for(let x=0;x<canvas.width;x+=grid*2){
  ctx.fillStyle='#8b4513';
  ctx.fillRect(x,canvas.height-wallThickness,grid*2-2,wallThickness);
  ctx.fillStyle='#654321';
  ctx.fillRect(x+2,canvas.height-wallThickness+2,grid*2-6,wallThickness-4);
 }
 // Left wall
 for(let y=0;y<canvas.height;y+=grid*2){
  ctx.fillStyle='#8b4513';
  ctx.fillRect(0,y,wallThickness,grid*2-2);
  ctx.fillStyle='#654321';
  ctx.fillRect(2,y+2,wallThickness-4,grid*2-6);
 }
 // Right wall
 for(let y=0;y<canvas.height;y+=grid*2){
  ctx.fillStyle='#8b4513';
  ctx.fillRect(canvas.width-wallThickness,y,wallThickness,grid*2-2);
  ctx.fillStyle='#654321';
  ctx.fillRect(canvas.width-wallThickness+2,y+2,wallThickness-4,grid*2-6);
 }
 
 snake.forEach((s,i)=>{
  if(i===0){
   ctx.fillStyle='#22c55e';
   ctx.fillRect(s.x*grid,s.y*grid,grid-2,grid-2);
   ctx.fillStyle='#fff';
   let eyeX=s.x*grid+(dx===1?14:dx===-1?4:7);
   let eyeY=s.y*grid+(dy===1?14:dy===-1?4:7);
   ctx.fillRect(eyeX,eyeY,3,3);
   ctx.fillRect(eyeX+(dx===0?6:0),eyeY+(dy===0?6:0),3,3);
  }else{
   ctx.fillStyle='#16a34a';
   ctx.fillRect(s.x*grid+1,s.y*grid+1,grid-4,grid-4);
  }
 });
 
 ctx.fillStyle='#dc2626';
 ctx.beginPath();
 ctx.arc(food.x*grid+grid/2,food.y*grid+grid/2,grid/2-2,0,Math.PI*2);
 ctx.fill();
 ctx.fillStyle='#15803d';
 ctx.fillRect(food.x*grid+grid/2-2,food.y*grid,4,6);
 
 ctx.fillStyle='#475569';
 obstacles.forEach(o=>{
  ctx.fillRect(o.x*grid,o.y*grid,grid-2,grid-2);
  ctx.fillStyle='#334155';
  ctx.fillRect(o.x*grid+2,o.y*grid+2,grid-6,grid-6);
  ctx.fillStyle='#475569';
 });
 
 if(powerup){
  ctx.fillStyle='#fbbf24';
  ctx.beginPath();
  ctx.arc(powerup.x*grid+grid/2,powerup.y*grid+grid/2,grid/2-2,0,Math.PI*2);
  ctx.fill();
  ctx.fillStyle='#fff';
  ctx.font='12px Arial';
  ctx.fillText('★',powerup.x*grid+5,powerup.y*grid+14);
 }
 document.getElementById("ui").innerText=`Score: ${score} | Level: ${level}`;
}

function gameOver(){
 gameRunning=false;
 document.getElementById("finalScore").innerText=`Final Score: ${score}`;
 document.getElementById("gameOver").style.display='flex';
}

let lastTime=0;
function gameLoop(time){
 if(time-lastTime>speed){
  update();
  draw();
  lastTime=time;
 }
 requestAnimationFrame(gameLoop);
}

spawnObstacles();
gameLoop(0);
</script>
<script>
// Touch Swipe Controls
let touchStartX=0,touchStartY=0;
canvas.addEventListener('touchstart',e=>{
 e.preventDefault();
 touchStartX=e.touches[0].clientX;
 touchStartY=e.touches[0].clientY;
});
canvas.addEventListener('touchend',e=>{
 e.preventDefault();
 let touchEndX=e.changedTouches[0].clientX;
 let touchEndY=e.changedTouches[0].clientY;
 let diffX=touchEndX-touchStartX;
 let diffY=touchEndY-touchStartY;
 if(Math.abs(diffX)>Math.abs(diffY)){
  if(diffX>30&&dx===0){dx=1;dy=0;}
  else if(diffX<-30&&dx===0){dx=-1;dy=0;}
 }else{
  if(diffY>30&&dy===0){dx=0;dy=1;}
  else if(diffY<-30&&dy===0){dx=0;dy=-1;}
 }
});
</script>
</body>
</html>
